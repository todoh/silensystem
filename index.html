<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Silenos Conexión</title>
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Custom styles -->
    <link rel="stylesheet" href="style3.css">
    
    <!-- Firebase SDKs -->
    <!-- Removed type="module" as these are generally loaded as regular scripts for global access -->
    <script src="https://www.gstatic.com/firebasejs/10.9.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.9.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.9.0/firebase-firestore.js"></script>
    
    <!-- PeerJS for P2P connection -->
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
</head>
<body>

    <div id="app-container">
        <!-- Login Screen -->
        <div id="login-screen" class="screen active">
            <div class="login-box">
                <h1>Silenos Conexión</h1>
                <p>Inicia sesión con Google para conectar</p>
                <!-- Google Sign-In Button -->
                <button id="google-login-btn" class="google-btn">
                    <i class="fab fa-google"></i> Iniciar sesión con Google
                </button>
            </div>
        </div>

        <!-- Main Screen (Lobby) -->
        <div id="main-screen" class="screen">
             <header>
                <h2>Bienvenido, <span id="current-username"></span></h2>
                <button id="logout-btn"><i class="fas fa-sign-out-alt"></i> Salir</button>
            </header>
            <div class="main-layout">
                <div class="user-lists">
                    <div class="list-container">
                        <h3><i class="fas fa-users"></i> Usuari@s</h3>
                        <ul id="all-users-list"></ul>
                    </div>
                    <div class="list-container">
                        <h3><i class="fas fa-user-friends"></i> Contactos</h3>
                        <ul id="friends-list"></ul>
                    </div>
                </div>
                <div class="requests-container">
                    <h3><i class="fas fa-user-plus"></i> Solicitudes de Contacto</h3>
                    <ul id="friend-requests-list"></ul>
                </div>
            </div>
        </div>

        <!-- Video Call Screen -->
        <div id="video-call-screen" class="screen">
            <div class="video-grid">
                <div class="video-wrapper video-wrapper-remote"> <!-- Class added for remote video -->
                    <video id="remote-video" autoplay></video>
                    <div class="user-tag">Remoto</div>
                </div>
                <div class="video-wrapper local">
                    <video id="local-video" autoplay muted></video>
                    <div class="user-tag">Tú</div>
                </div>
            </div>
            <div class="call-controls">
                <button id="toggle-mic-btn" class="control-btn"><i class="fas fa-microphone"></i></button>
                <button id="toggle-camera-btn" class="control-btn"><i class="fas fa-video"></i></button>
                <button id="toggle-screen-share-btn" class="control-btn"><i class="fas fa-desktop"></i></button> <!-- New button for screen sharing -->
                <button id="end-call-btn" class="control-btn end-call"><i class="fas fa-phone-slash"></i></button>
            </div>

            <!-- P2P Chat Container -->
            <div id="p2p-chat-container" class="p2p-chat-container minimized">
                <div class="chat-header">
                    <h4>Chat de la Llamada</h4>
                    <button id="toggle-chat-btn" class="control-btn chat-toggle-btn"><i class="fas fa-chevron-down"></i></button>
                </div>
                <div class="chat-messages" id="chat-messages">
                    <!-- Chat messages will be inserted here -->
                </div>
                <div class="chat-input-area">
                    <input type="text" id="chat-message-input" placeholder="Escribe un mensaje...">
                    <button id="send-chat-message-btn"><i class="fas fa-paper-plane"></i></button>
                    <!-- <input type="file" id="attach-image-input" accept="image/*" style="display: none;"> -->
                    <!-- <button id="attach-image-btn" class="chat-action-btn"><i class="fas fa-image"></i></button> -->
                </div>
            </div>
        </div>
    </div>
    
    <!-- Incoming Call Modal -->
    <div id="incoming-call-modal" class="modal-container">
        <div class="modal-content">
            <p><span id="caller-name"></span> te está llamando...</p>
            <div class="modal-buttons">
                <button id="accept-call-btn" class="btn-success"><i class="fas fa-phone"></i> Aceptar</button>
                <button id="decline-call-btn" class="btn-danger"><i class="fas fa-phone-slash"></i> Rechazar</button>
            </div>
        </div>
    </div>

    <!-- Your main JavaScript file -->
    <script type="module" src="app.js"></script>
</body>
</html>
