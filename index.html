<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Editor de Escena Interactivo v3 - Three.js</title>

    <!-- Estilos y fuentes -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="editor-escenas.css">
    
    <!-- Scripts de utilidades que no tienen dependencias cr√≠ticas de carga -->
    <script src="https://unpkg.com/gifler@0.1.0/gifler.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Importmap DEBE estar en el head para que los m√≥dulos se resuelvan correctamente -->
    <script type="importmap">
        {
            "imports": {
                "three": "https://cdn.jsdelivr.net/npm/three@0.128.0/build/three.module.js",
                "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.128.0/examples/jsm/",
                "tween": "https://cdn.jsdelivr.net/npm/@tweenjs/tween.js@21.0.0/dist/tween.esm.js"
            }
        }
    </script>
</head>
<body>

    <!-- Todo tu contenido HTML va aqu√≠ como lo ten√≠as -->
    <div id="main-container">
        <div id="palette-panel" class="sidebar">
            <h2>Paleta</h2>
            <button class="btn-base" data-type="tree">üå≥ A√±adir √Årbol</button>
            <button class="btn-base" data-type="red_flower">üå∏ A√±adir Flor Roja</button>
            <button class="btn-base" data-type="yellow_flower">üåº A√±adir Flor Amarilla</button>
            <button class="btn-base" data-type="pyramid">üî∫ A√±adir Pir√°mide</button>
            <div id="custom-model-container"></div>
            <div id="custom-image-container"></div>
            <hr class="my-6 border-zinc-700">
             <h2>Suelo</h2>
             <label class="flex items-center space-x-2 cursor-pointer">
                <input type="checkbox" id="ground-texture-toggle" class="form-checkbox h-5 w-5 text-indigo-600 bg-zinc-700 border-zinc-600 rounded" checked>
                <span class="text-zinc-300">Textura de c√©sped</span>
            </label>
             <hr class="my-6 border-zinc-700">
             <h2>Herramientas</h2>
             <button id="export-btn" class="btn-base btn-primary">üì∏ Exportar a PNG</button>
             <button id="render-video-btn" class="btn-base btn-action">üìπ Renderizar a MP4</button>
             <label for="gltf-input" class="btn-base btn-secondary">üì¶ Importar GLB</label>
             <input type="file" id="gltf-input" class="hidden" accept=".glb">
             <label for="image-input" class="btn-base btn-tertiary">üñºÔ∏è Importar Imagen</label>
             <input type="file" id="image-input" class="hidden" accept="image/png, image/jpeg, image/gif">
        </div>

        <div id="scene-container"></div>

        <div id="inspector-panel" class="sidebar">
            <h2>Inspector</h2>
            <div id="inspector-content"><p class="text-zinc-400">Selecciona un objeto.</p></div>
            <hr class="my-6 border-zinc-700">
            <h2>Objetos en Escena</h2>
            <ul id="object-list"></ul>
        </div>
    </div>
    <div id="timeline-panel">
        <div id="timeline-controls">
            <button id="play-btn" class="btn-base w-auto">‚ñ∂Ô∏è Play</button>
            <button id="pause-btn" class="btn-base w-auto">‚è∏Ô∏è Pausa</button>
            <button id="reset-btn" class="btn-base w-auto">‚è™ Reset</button>
        </div>
        <div id="timeline-tracks"><p class="text-zinc-400 text-sm">A√±ade una animaci√≥n.</p></div>
    </div>
    <div id="custom-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <p id="modal-text"></p>
            <p id="modal-progress"></p>
            <input type="text" id="modal-input" class="modal-input" style="display: none;">
            <div class="modal-buttons">
                <button id="modal-cancel-btn" class="btn-base w-auto">Cancelar</button>
                <button id="modal-ok-btn" class="btn-base w-auto btn-primary">OK</button>
            </div>
        </div>
    </div>

    <!-- ===== SECCI√ìN CR√çTICA DE SCRIPTS ===== -->
    <!-- 1. Cargar la librer√≠a FFmpeg primero. Se coloca al final del body para asegurar que todo el HTML est√© listo. -->
 
    
    <!-- 2. Cargar nuestro script principal DESPU√âS. Como es un m√≥dulo, buscar√° el importmap en el head. -->
    <script type="module" src="editor-escenas.js"></script>

</body>
</html>
```

### **Pasos a seguir:**

1.  **Copia y pega** el contenido completo del bloque de c√≥digo de arriba en tu archivo `index.html`, sobrescribiendo todo lo que ten√≠as.
2.  **No modifiques** tu archivo `editor-escenas.js`. El c√≥digo que te di en el paso anterior para la funci√≥n `renderVideo` es correcto y funcionar√° con este nuevo `index.html`.
3.  Guarda los cambios y prueba la funcionalidad de renderizado de nuevo.

Con este cambio, el error deber√≠a desaparecer de una vez por todas. La clave es cargar los scripts al final del `<body>` y en el orden correcto para garantizar que las dependencias est√©n disponibles cuando se necesit